<%- include("navbar.ejs") %>

<section class="hero-section-img">
  <div class="container">
    <div class="row justify-content-center text-center">
      <div class="col-lg-8">
        <h1 class="hero-title display-4 fw-bold mb-4 animate__animated animate__fadeInDown">Healthy Recipes</h1>
        <p class="hero-subtitle lead mb-5 animate__animated animate__fadeInUp animate__delay-1s">
          "Simple, organic, and flavorful recipes using our finest homemade masalas"
        </p>
      </div>
    </div>
  </div>
</section>

<!-- Recipe Banner -->
<section>
  <div class="container">
    <div class="row">
      <div class="col-md-12 mt-5">
        <div class="recipe-banner">
          <div class="text-light p-8 ms-5">
            <h1 class="recipe-banner__title" id="recipe-title"><%= mainRecipe.dish_name %></h1>
            <p class="recipe-banner__subtitle" id="recipe-heading"><%= mainRecipe.heading %></p>
          </div>
        </div>

        <!-- About Recipe -->
        <div class="recipe-about p-4 mb-5">
          <h2 class="fw-bold recipe-about__title mb-3">About This Recipe</h2>
          <p class="mb-4" id="about-recipe"><%= mainRecipe.about_recipe %></p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- Ingredients and Instructions -->
<div class="recipe-container py-5">
  <div class="row g-4">
    <div class="col-md-4">
      <div class="recipe-section__header">
        <h2 class="h4 fw-bold">Ingredients</h2>
        <p class="mb-0 text-light">For the authentic experience</p>
      </div>
      <div class="recipe-section__content">
        <ul class="list-unstyled" id="ingredients-list">
          <% mainRecipe.ingredients_list.forEach(function(ing) { %>
            <li class="recipe-ingredient p-2 border rounded mb-2"><%= ing %></li>
          <% }); %>
        </ul>
      </div>
    </div>
    <div class="col-md-8">
      <div class="recipe-section__header">
        <h2 class="h4 fw-bold">Instructions</h2>
        <p class="mb-0 text-light">Step-by-step guide with images</p>
      </div>
      <div class="recipe-section__content" id="recipe-steps">
        <% for (let i = 1; i <= 6; i++) { 
            const step = mainRecipe[`step${i}`];
            const img = mainRecipe[`image${i}`];
            if (step) { %>
          <h5>Step <%= i %></h5>
          <p><%= step %></p>
          <% if (img) { %>
            <img src="<%= img %>" alt="Step <%= i %> image" width="400px" class="img-fluid mb-3 rounded">
          <% } %>
        <% }} %>
      </div>
    </div>
  </div>
</div>

<!-- More Recipes -->
<div class="recipe-container">
  <h2 class="more-recipes__title">More Recipes with Our Masale</h2>
  <div class="more-recipes__grid">
    <% data.forEach(function(r, i) { %>
      <div class="recipe-card">
        <img src="<%= r.image1 %>" alt="<%= r.dish_name %>" class="recipe-card__image">
        <div class="recipe-card__content">
          <h3 class="recipe-card__title"><%= r.dish_name %></h3>
          <p class="recipe-card__description"><%= r.heading.substring(0, 70) %>...</p>
          <button class="recipe-card__button view-btn" data-index="<%= i %>">View Recipe</button>
        </div>
      </div>
    <% }); %>
  </div>
</div>

<script>
  const allRecipes = <%- JSON.stringify(data) %>;

  document.querySelectorAll(".view-btn").forEach(btn => {
    btn.addEventListener("click", () => {
      const index = btn.getAttribute("data-index");
      const recipe = allRecipes[index];

      document.getElementById("recipe-title").innerText = recipe.dish_name;
      document.getElementById("recipe-heading").innerText = recipe.heading;
      document.getElementById("about-recipe").innerText = recipe.about_recipe;

      // Update ingredients
      const ingList = document.getElementById("ingredients-list");
      ingList.innerHTML = "";
      recipe.ingredients_list.forEach(ing => {
        const li = document.createElement("li");
        li.className = "recipe-ingredient p-2 border rounded mb-2";
        li.innerText = ing;
        ingList.appendChild(li);
      });

      // Update steps with images
      const stepsContainer = document.getElementById("recipe-steps");
      stepsContainer.innerHTML = "";
      for (let i = 1; i <= 6; i++) {
        const step = recipe[`step${i}`];
        const img = recipe[`image${i}`];
        if (step) {
          const h5 = document.createElement("h5");
          h5.textContent = `Step ${i}`;
          const p = document.createElement("p");
          p.textContent = step;

          stepsContainer.appendChild(h5);
          stepsContainer.appendChild(p);

          if (img) {
            const imgTag = document.createElement("img");
            imgTag.src = img;
            imgTag.alt = `Step ${i} image`;
            imgTag.className = "img-fluid mb-3 rounded";
            stepsContainer.appendChild(imgTag);
          }
        }
      }
    });
  });
</script>

<%- include("footer.ejs") %>
